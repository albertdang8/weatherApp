//dear, future me, here: ° . thank me later xoxox UwU
const sunnySvg = `<svg class = "boopRight" width="15" height="15" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M12 4C11.7167 4 11.4793 3.904 11.288 3.712C11.096 3.52067 11 3.28333 11 3V2C11 1.71667 11.096 1.479 11.288 1.287C11.4793 1.09567 11.7167 1 12 1C12.2833 1 12.521 1.09567 12.713 1.287C12.9043 1.479 13 1.71667 13 2V3C13 3.28333 12.9043 3.52067 12.713 3.712C12.521 3.904 12.2833 4 12 4ZM12 23C11.7167 23 11.4793 22.904 11.288 22.712C11.096 22.5207 11 22.2833 11 22V21C11 20.7167 11.096 20.4793 11.288 20.288C11.4793 20.096 11.7167 20 12 20C12.2833 20 12.521 20.096 12.713 20.288C12.9043 20.4793 13 20.7167 13 21V22C13 22.2833 12.9043 22.5207 12.713 22.712C12.521 22.904 12.2833 23 12 23ZM21 13C20.7167 13 20.4793 12.904 20.288 12.712C20.096 12.5207 20 12.2833 20 12C20 11.7167 20.096 11.479 20.288 11.287C20.4793 11.0957 20.7167 11 21 11H22C22.2833 11 22.5207 11.0957 22.712 11.287C22.904 11.479 23 11.7167 23 12C23 12.2833 22.904 12.5207 22.712 12.712C22.5207 12.904 22.2833 13 22 13H21ZM2 13C1.71667 13 1.47933 12.904 1.288 12.712C1.096 12.5207 1 12.2833 1 12C1 11.7167 1.096 11.479 1.288 11.287C1.47933 11.0957 1.71667 11 2 11H3C3.28333 11 3.521 11.0957 3.713 11.287C3.90433 11.479 4 11.7167 4 12C4 12.2833 3.90433 12.5207 3.713 12.712C3.521 12.904 3.28333 13 3 13H2ZM18 6C17.8167 5.81667 17.725 5.59167 17.725 5.325C17.725 5.05833 17.8167 4.81667 18 4.6L18.35 4.225C18.5333 4.025 18.7667 3.925 19.05 3.925C19.3333 3.925 19.575 4.025 19.775 4.225C19.975 4.425 20.0793 4.67067 20.088 4.962C20.096 5.254 19.9917 5.49167 19.775 5.675L19.4 6.025C19.2167 6.20833 18.9873 6.3 18.712 6.3C18.4373 6.3 18.2 6.2 18 6ZM4.225 19.775C4.025 19.575 3.921 19.3293 3.913 19.038C3.90433 18.746 4.00833 18.5083 4.225 18.325L4.6 17.975C4.78333 17.7917 5.01233 17.7 5.287 17.7C5.56233 17.7 5.8 17.8 6 18C6.18333 18.1833 6.275 18.4127 6.275 18.688C6.275 18.9627 6.18333 19.2 6 19.4L5.65 19.775C5.46667 19.975 5.23333 20.075 4.95 20.075C4.66667 20.075 4.425 19.975 4.225 19.775ZM18.325 19.775L17.975 19.4C17.7917 19.2167 17.7 18.9873 17.7 18.712C17.7 18.4373 17.8 18.2 18 18C18.1833 17.8167 18.4127 17.725 18.688 17.725C18.9627 17.725 19.2 17.8167 19.4 18L19.775 18.35C19.975 18.5333 20.075 18.7667 20.075 19.05C20.075 19.3333 19.975 19.575 19.775 19.775C19.575 19.975 19.3293 20.079 19.038 20.087C18.746 20.0957 18.5083 19.9917 18.325 19.775ZM4.6 6L4.225 5.65C4.025 5.46667 3.925 5.23333 3.925 4.95C3.925 4.66667 4.025 4.425 4.225 4.225C4.425 4.025 4.671 3.92067 4.963 3.912C5.25433 3.904 5.49167 4.00833 5.675 4.225L6.025 4.6C6.20833 4.78333 6.3 5.01233 6.3 5.287C6.3 5.56233 6.2 5.8 6 6C5.81667 6.18333 5.59167 6.275 5.325 6.275C5.05833 6.275 4.81667 6.18333 4.6 6ZM12 18C10.3333 18 8.91667 17.4167 7.75 16.25C6.58333 15.0833 6 13.6667 6 12C6 10.3333 6.58333 8.91667 7.75 7.75C8.91667 6.58333 10.3333 6 12 6C13.6667 6 15.0833 6.58333 16.25 7.75C17.4167 8.91667 18 10.3333 18 12C18 13.6667 17.4167 15.0833 16.25 16.25C15.0833 17.4167 13.6667 18 12 18ZM12 16C13.1167 16 14.0627 15.6123 14.838 14.837C15.6127 14.0623 16 13.1167 16 12C16 10.8833 15.6127 9.93733 14.838 9.162C14.0627 8.38733 13.1167 8 12 8C10.8833 8 9.93767 8.38733 9.163 9.162C8.38767 9.93733 8 10.8833 8 12C8 13.1167 8.38767 14.0623 9.163 14.837C9.93767 15.6123 10.8833 16 12 16Z" fill="black"/>
</svg>`;

const windSvg = `<svg class = "boopRight" width="15" height="15" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M22.125 9.625C22.4909 9.2727 22.9371 9.01489 23.4251 8.8739C23.913 8.7329 24.428 8.71298 24.9254 8.81584C25.4228 8.91871 25.8876 9.14126 26.2797 9.46424C26.6717 9.78722 26.979 10.2009 27.1752 10.6694C27.3713 11.1379 27.4503 11.6472 27.4052 12.1531C27.3602 12.6591 27.1925 13.1464 26.9167 13.5729C26.641 13.9994 26.2653 14.3523 25.8225 14.601C25.3796 14.8496 24.8827 14.9866 24.375 15H2.5M12 5.75C12.2896 5.45463 12.648 5.23573 13.043 5.11294C13.438 4.99014 13.8573 4.96728 14.2633 5.0464C14.6693 5.12553 15.0494 5.30416 15.3694 5.5663C15.6894 5.82843 15.9393 6.16587 16.0968 6.54837C16.2543 6.93087 16.3144 7.34647 16.2718 7.75792C16.2292 8.16938 16.0851 8.56382 15.8525 8.9059C15.6199 9.24797 15.3061 9.52699 14.9392 9.71794C14.5722 9.90889 14.1636 10.0058 13.75 10H2.5M15.75 24.25C16.0396 24.5454 16.398 24.7643 16.793 24.8871C17.188 25.0099 17.6073 25.0327 18.0133 24.9536C18.4193 24.8745 18.7994 24.6958 19.1194 24.4337C19.4394 24.1716 19.6893 23.8341 19.8468 23.4516C20.0043 23.0691 20.0644 22.6535 20.0218 22.2421C19.9792 21.8306 19.8351 21.4362 19.6025 21.0941C19.3699 20.752 19.0561 20.473 18.6892 20.2821C18.3222 20.0911 17.9136 19.9942 17.5 20H2.5" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>`;

const moistSvg = `<svg class = "boopRight" width="15" height="15" viewBox="0 0 18 25" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M16.0087 11.1184L9.79406 1.22219C9.70389 1.09564 9.58478 0.99247 9.44666 0.921284C9.30853 0.850098 9.15539 0.812958 9 0.812958C8.84461 0.812958 8.69147 0.850098 8.55334 0.921284C8.41522 0.99247 8.29611 1.09564 8.20594 1.22219L1.96313 11.1653C1.09583 12.5643 0.612718 14.1672 0.5625 15.8125C0.5625 18.0503 1.45145 20.1964 3.03379 21.7787C4.61612 23.3611 6.76224 24.25 9 24.25C11.2378 24.25 13.3839 23.3611 14.9662 21.7787C16.5486 20.1964 17.4375 18.0503 17.4375 15.8125C17.3836 14.1492 16.8907 12.5297 16.0087 11.1184ZM9 22.375C7.2602 22.3728 5.5923 21.6807 4.36208 20.4504C3.13185 19.2202 2.43973 17.5523 2.4375 15.8125C2.48733 14.5015 2.88113 13.2267 3.57938 12.1159L4.45594 10.7191L13.9003 20.1634C13.2869 20.8584 12.5328 21.415 11.688 21.7965C10.8432 22.1779 9.92694 22.3745 9 22.375Z" fill="black"/>
</svg>`;

const weatherSvg = `<svg class = "boopRight" width="15" height="15" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M13.75 1.25L16.7375 5.525C15.8125 5.1875 14.8 5 13.75 5C12.7 5 11.6875 5.1875 10.7625 5.525L13.75 1.25ZM2.92499 7.5L8.12499 7.0625C7.34918 7.7178 6.68987 8.49967 6.17499 9.375C5.62499 10.3 5.31249 11.25 5.13749 12.2375L2.92499 7.5ZM2.94999 20L5.14999 15.2875C5.51744 17.3031 6.56804 19.1307 8.12499 20.4625L2.94999 20ZM24.5625 7.5L22.35 12.2375C21.996 10.2135 20.9432 8.37771 19.375 7.05L24.5625 7.5ZM28.75 16.25H26.25C26.25 18.8125 25.275 21.375 23.325 23.325C22.3975 24.2558 21.2946 24.9936 20.0803 25.4957C18.8659 25.9977 17.564 26.2541 16.25 26.25V28.75C19.45 28.75 22.65 27.5 25.0875 25.0875C27.525 22.675 28.75 19.45 28.75 16.25ZM23.75 16.25H21.25C21.25 17.5 20.7625 18.8125 19.7875 19.7875C18.8125 20.7625 17.5 21.25 16.25 21.25V23.75C17.2354 23.7518 18.2115 23.5591 19.1223 23.1828C20.033 22.8065 20.8605 22.2541 21.5573 21.5573C22.2541 20.8605 22.8065 20.033 23.1828 19.1223C23.559 18.2115 23.7518 17.2354 23.75 16.25ZM13.75 10C15.8125 10 17.5 11.6875 17.5 13.75C17.5 15.8125 15.8125 17.5 13.75 17.5C11.6875 17.5 9.99999 15.8125 9.99999 13.75C9.99999 11.6875 11.6875 10 13.75 10ZM13.75 7.5C10.3 7.5 7.49999 10.3 7.49999 13.75C7.49999 17.2 10.3 20 13.75 20C17.2 20 20 17.2 20 13.75C20 10.3 17.2 7.5 13.75 7.5Z" fill="black"/>
</svg>
`;

async function getData(city) {
  const apiKey = `7a29d6e60409ed4601d0c9d3bf561eb4`;
  const photoApi = `TDS2ZnsBwXIvsBAdjtz9TLvaivU3hK4GVdDi_-UTHDs`;
  try {
    const result = await fetch(
      `https://api.openweathermap.org/data/2.5/forecast?q=${city}&appid=${apiKey}&units=imperial`
    );
    const data = await result.json();
    isItPronouncedDataOr(data);
    console.log(data);
  } catch (error) {
    console.log(error);
  }
  //experi-mentally unstable thoughts
  // try {
  //   const unsplashResult = await fetch(`https://api.unsplash.com/photos/random?query=${city}&client_id=${photoApi}`);
  //   const unsplashData = await unsplashResult.json();
  //   setBodyBackground(unsplashData)
  //   console.log(unsplashData);
  // } catch (error) {
  //   console.log(error);
  // }
}

function isItPronouncedDataOr(data) {
  let objectList = data.list;
  let cardsHtml = "";

  objectList.forEach((card, index) => {
    let temp = Math.round(objectList[index].main.temp); //F
    const minTemp = Math.round(objectList[index].main.temp_min);
    const maxTemp = Math.round(objectList[index].main.temp_max);
    let moistness = objectList[index].main.humidity; //%
    let mainWeather = objectList[index].weather[0].main;
    let mainDescription = objectList[index].weather[0].description;
    let clouds = objectList[index].clouds.all; //%
    let windSpeed = objectList[index].wind.speed; //mph
    let gust = objectList[index].wind.gust; //mph

    let hardCard = `<ul>
    <li class="straighten">${sunnySvg} Temp: ${temp}°F   <span class="smol boopLeft">${minTemp}° | ${maxTemp}°</span>.</li>
    <li class="straighten">${weatherSvg} Weather: ${mainWeather} — <span class="smol boopLeft">${mainDescription}</span>.</li>
    <li class="straighten">${windSvg} Wind: ${windSpeed}<span class = "smol boopRight">mph</span> with potential gusts of ${gust}.</li>
    <li class="straighten">${moistSvg} Humidity: ${moistness}% Clouds: ${clouds}%</li>
    </ul>`;

    const date = new Date(card.dt_txt);
    const monthName = date.toLocaleString("default", { month: "long" });
    const dateString = `${monthName}, ${date.getDate()}`;
    const timeString = format12HourTime(date.getHours(), date.getMinutes());
    cardsHtml += `<article class="accordion-panel">
      <input id="accordion-question-${index}" name="accordion" type="radio" />
        <label for="accordion-question-${index}">
          <span>${timeString} ${dateString}</span>
          <i class="ri-add-line open"></i>
          <i class="ri-subtract-line close"></i>
        </label>
        <div class="accordion-body">
          <p class="accordion-answer">
            ${hardCard}
          </p>
        </div>
    </article>`;
  });
  document.querySelector("#card-container").innerHTML = cardsHtml;
  //flourishing some silly goose code because i aint got no time for serious sally work at 4am.
  let cityTitle = document.querySelector("title");
  let cityHead = document.querySelector("#cityHead");
  cityTitle.innerHTML = `${data.city.name}'s 3-Hour Forecast`;
  cityHead.innerHTML = ` for ${data.city.name}`;
}

function format12HourTime(hours, minutes) {
  const ampm = hours >= 12 ? "PM" : "AM";
  const formattedHours = hours % 12 || 12;
  const formattedMinutes = minutes < 10 ? `0${minutes}` : minutes;
  return `${formattedHours}:${formattedMinutes} ${ampm}`;
}

getData("");

const cityInputForm = document.querySelector(".search");

cityInputForm.addEventListener("submit", async (e) => {
  e.preventDefault();

  const searchInput = document.querySelector(".search__input");
  city = searchInput.value.trim();
  await getData(city);
  searchInput.value = "";
});

// ya boi bit off more than he could chew
// function setBodyBackground(backgroundUrl) {
//   document.body.style.backgroundImage = `url(${backgroundUrl.urls.regular})`;
//   document.body.style.backgroundRepeat = "no-repeat";
//   document.body.style.backgroundSize = "cover";
// }

function nowWeHere() {
  document.body.scrollTop = 0; //Safari
  document.documentElement.scrollTop = 0; //Varsity team
}